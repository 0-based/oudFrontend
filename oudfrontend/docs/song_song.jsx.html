<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: song/song.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: song/song.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { Component} from 'react';
import './song.css';
import {BrowserRouter as Router, Link} from "react-router-dom";
import axios from 'axios'


/**
 * @classdesc this is a component that renders playlist page
 * @author Ahmed Walid &lt;ahmedwa1999@gmail.com>
 * @class
 * @param {string} key the Id of the playlist
 * @param {string} clickedId the Id of the clicked song
 * @param {func} handleClick  called when the user click on the song
 * @param {func} handlePlay called when the user click on the play button
 * 
 * @property {object} state carries the state of the component
 * @param {object} track song object
 * @property {boolean} state.hover true if the mouse is on the song false otherwise
 * @property {string} state.albumName name of the album
 * @property {object} state.playlist carries all the information of the playlist
 * @property {Array.&lt;track>} state.tracks array of all the songs in the playlist
 * @property {boolean} state.playing true when the song is playing. Otherwise, it is false
 * @property {boolean} state.queued true when the song is added to queue. Otherwise, it is false
 * @property {boolean} state.cliked true when the song is focused
 * @property {boolean} state.displayDropdown true when the song optopns are visible
 * @property {boolean} state.saved true when the song is saved to likedSongs
 * 
 * @returns {
 *              &lt;div>
 *               &lt;div classname="playlistHeader">
 *                  &lt;div classname="imageContainer">
 *                      &lt;img/>
 *                  &lt;/div>
 * 
 *                  &lt;div classname="playlistHeaderBody">
 *                      &lt;HeaderBodyTop/>
 *                      &lt;HeaderBodyBottom/>
 *                  &lt;/div>
 *                  &lt;SongList/>
 *               &lt;/div>
 *              &lt;/div>
 *          
 *          }
 */
class Song extends Component{
    /**
     * 
     * @constructor 
     */
    constructor(props){
        super(props);
        this.state={
            hover : false,
            track:this.props.track,
            albumName:'',
            playing:false,
            displayDropdown:false,
            saved:false,
            queued:false,
            clicked:false
        };
    }
    /**
     * sets state.hover to true and called onMouseEnter
     * @returns {void}
     */
    hover = ()=> this.setState({hover : true});
    /**
     * sets state.hover to false and called onMouseLeave
     * @returns {void}
     */
    notHover = ()=> this.setState({hover:false});
    /**
     *gets the name of the album of the song
     * @returns {void}
     */
    componentDidMount(){
        axios.get(`http://localhost:3000/albums/${this.state.track.albumId}/`)
        .then((response)=> {
            const albumName = response.data.name
            this.setState({albumName:albumName})
        })
        .catch((error)=> {
            console.log(error);
        }); 
    }
    /**
     *if the recieved props is changed it sets state.clicked to true or 
     *false and calls hh() 
     * @param {object} nextProps 
     */
    componentWillReceiveProps(nextProps){
        if(nextProps.clickedId !== this.props.clickedId){
            this.setState({clicked:(nextProps.clickedId === this.props.track.id)?true:false})    
            this.hh();
        }  
    }
    /**
     * called when the play button of the song is clicked and it calls the passed function from parent
     * @param {void} 
     */
    playSongClicked(){

        this.props.handlePlay(this.state.track.id)
    }
    /**
     * saves the song to liked songs
     * @param {void} 
     */
    handleSaving(){
        this.toggleDropdown()
        if(this.state.saved === false){
            axios.post('http://localhost:3000/likedSongs/',this.state.track)
            .then(function (response) {
                console.log(response);

            })
            .catch(function (error) {
                console.log(error);
            });
            this.setState({saved:true})

        }
        else{
            axios.delete(`http://localhost:3000/likedSongs/${this.state.track.id}`)
            .then(function (response) {
                console.log(response);
            })
            .catch(function (error) {
                console.log(error);
            });
            this.setState({saved:false})

        }
    }
    /**
     * Adds the song to the queue
     * @param {void} 
     */
    handleQueue(){
        this.toggleDropdown()
        if(this.state.queued === false){
            axios.post('http://localhost:3000/queue/',this.state.track)
            .then(function (response) {
                console.log(response);

            })
            .catch(function (error) {
                console.log(error);
            });
            this.setState({queued:true})

        }
        else{
            axios.delete(`http://localhost:3000/queue/${this.state.track.id}`)
            .then(function (response) {
                console.log(response);
            })
            .catch(function (error) {
                console.log(error);
            });
            this.setState({queued:false})

        }
    }
    /**
     * called when state.clicked changes
     * it sets state.displayDropdown to false if clicked is true
     * @param {void} 
     */
    hh(){
        if(this.state.clicked === true)
        {
            this.setState({displayDropdown:false})
        }
    }
    /**
     * called when the options button is clicked to toggle state.displayDropdown
     * @param {void} 
     */
    toggleDropdown(){
        this.setState({displayDropdown:!this.state.displayDropdown})
        console.log("click -->" + this.state.clicked)
        console.log("display -->" + this.state.displayDropdown)

    }
    render(){
        
        return(
            &lt;Router>
                &lt;button onClick={()=>{this.props.handleClick(this.state.track.id)}} className="song row" id='song' onMouseEnter={this.hover} onMouseLeave={this.notHover}>
                    
                        &lt;div  className='songIcon col-1'>
                            &lt;button className='songButton' onClick={this.playSongClicked.bind(this)}>
                            &lt;img src={(this.state.hover||this.state.clicked)? require('./play.png'):require('./musicIcon.png')}
                             width='12' height='14' 
                             alt='play music icon'/>
                             &lt;/button>
                        &lt;/div>

                        &lt;div className='songInfo col-8'>    
                            &lt;span className='whiteText'>{this.state.track.name}&lt;/span>
                            &lt;p>
                        &lt;span>{
                            this.state.track.artists.map((artist)=>{
                                return(&lt;span>
                                    &lt;Link to={`/artist/${artist.id}`} className='playlistAnchor'>{artist.name}&lt;/Link>
                                    &lt;span>, &lt;/span>
                                    &lt;/span>
                                    );
                                })}

                            &lt;/span>
                            &lt;Link to={`/albums/${this.state.track.albumId}`}className='playlistAnchor'>{this.state.albumName}&lt;/Link>
                            &lt;/p>
                        &lt;/div>

                        &lt;div  className='col-1'>
                            
                                &lt;div className="dropdown">
                                    &lt;button 
                                        onClick={this.toggleDropdown.bind(this)}
                                        className="songButton" 
                                        id='songDropdownButton'>
                                        &lt;h3 className='whiteText' 
                                        style={(this.state.hover||this.state.clicked)?{display:'block'}:{display:'none'}}>
                                        ...&lt;/h3>
                                     &lt;/button>

                                    &lt;div 
                                        style={this.state.displayDropdown &amp;&amp; this.state.clicked?{display: "block"}:{display: 'none'}}
                                        className="dropdownContent" id="dropdownContent">

                                        &lt;Link onClick={this.handleSaving.bind(this)} className="SongDropdownItem">
                                        {this.state.saved?'Remove From Your Liked Songs':'Save to your Liked Songs'}&lt;/Link>

                                        &lt;Link onClick={this.handleQueue.bind(this)}
                                        className="SongDropdownItem">
                                        {this.state.queued?'Remove From Queue':'Add to Queue'}&lt;/Link>

                                        &lt;Link className="SongDropdownItem">Add to Playlist&lt;/Link>
                                    &lt;/div>
                                &lt;/div> 
                        &lt;/div>

                        &lt;div className='col-2'>
                            &lt;p className='whiteText'>{this.state.track.songTime}3:34&lt;/p>
                        &lt;/div>
                    &lt;/button>
            &lt;/Router>

        );
    }
}

export default Song;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="addToPlaylist.html">addToPlaylist</a></li><li><a href="Album.html">Album</a></li><li><a href="CreatePlaylist.html">CreatePlaylist</a></li><li><a href="LikedSongs.html">LikedSongs</a></li><li><a href="Playlist.html">Playlist</a></li><li><a href="Song.html">Song</a></li><li><a href="SongList.html">SongList</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addToQueue">addToQueue</a></li><li><a href="global.html#HeaderBody">HeaderBody</a></li><li><a href="global.html#HeaderBodyBottom">HeaderBodyBottom</a></li><li><a href="global.html#HeaderBodyTop">HeaderBodyTop</a></li><li><a href="global.html#pause">pause</a></li><li><a href="global.html#resume">resume</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Thu Apr 02 2020 22:33:34 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
